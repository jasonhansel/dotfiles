# Use GNU Stow to install the included dotfiles

set -euo pipefail

ln -siT "$HOME/.config/Code" "$HOME/.config/Code - OSS"

rm -f ~/.config/alacritty/alacritty.yml
stow --no-folding -R --target=$HOME global


USERDIR="$(hostname)-$(whoami)"
if [ -d "users/$USERDIR" ] ; then
	cd users
	stow --no-folding -R --target=$HOME $USERDIR
	cd ..
else
	echo "No user-specific stuff at users/$USERDIR"
fi

ln -sfT $(readlink -f ~/.config/alacritty/alacritty.yml) ~/.config/alacritty/alacritty.yml || true

# NB: may also need pacman -S python-neovim
pip3 install --user neovim
vim +PlugInstall +qa

if which code
then
	cat vscode-extensions | while read -r EXTENSION
	do
		yes 0 | code --install-extension $EXTENSION || true
	done
fi
cd ..
